"use strict";(self.webpackChunkworklenz=self.webpackChunkworklenz||[]).push([[889],{63106:(C,z,_)=>{_.d(z,{I:()=>S});var e=_(65879),c=_(26254),M=_(62595),D=_(92574),x=_(42840),g=_(96814),u=_(60095),f=_(62612),t=_(62787),n=_(21406),i=_(52682),s=_(3599),p=_(16676),l=_.n(p),T=_(42012),v=_(70855),R=_(41958),w=_(73460);function O(o,d){if(1&o){const a=e.EpF();e.TgZ(0,"button",13)(1,"label",14),e.NdJ("ngModelChange",function(m){e.CHM(a);const h=e.oxw(2);return e.KtG(h.includeArchived=m)})("ngModelChange",function(m){e.CHM(a);const h=e.oxw(2);return e.KtG(h.onArchiveChange(m))}),e._uU(2," Include Archived Projects "),e.qZA()()}if(2&o){const a=e.oxw(2);e.Q6J("ngClass",a.includeArchived?"archived":""),e.xp6(1),e.Q6J("ngModel",a.includeArchived)}}function P(o,d){if(1&o&&(e.ynx(0),e.YNc(1,O,3,2,"button",12),e.BQk()),2&o){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.showArchivedToggle)}}function Y(o,d){if(1&o&&(e.TgZ(0,"button",17),e._uU(1),e._UZ(2,"span",18),e.qZA()),2&o){const a=e.oxw(3),r=e.MAs(9);e.Q6J("nzDropdownMenu",r)("nzTrigger","click")("nzPlacement","bottomRight"),e.xp6(1),e.hij(" ",a.durationLabel," "),e.xp6(1),e.Q6J("nzType","down")}}function A(o,d){1&o&&(e.ynx(0),e.TgZ(1,"nz-space"),e.YNc(2,Y,3,5,"button",16),e.qZA(),e.BQk())}function b(o,d){if(1&o&&(e.TgZ(0,"button",23),e._uU(1," Export "),e._UZ(2,"span",18),e.qZA()),2&o){e.oxw();const a=e.MAs(3),r=e.oxw(2);e.Q6J("nzType","primary")("nzLoading",r.exporting)("nzTrigger","click")("nzDropdownMenu",a)("nzPlacement","bottomRight"),e.xp6(2),e.Q6J("nzType","down")}}function U(o,d){if(1&o){const a=e.EpF();e.TgZ(0,"li",24),e.NdJ("click",function(){e.CHM(a);const m=e.oxw(3);return e.KtG(m.export())}),e._uU(1,"Excel"),e.qZA()}}function I(o,d){if(1&o){const a=e.EpF();e.TgZ(0,"li",24),e.NdJ("click",function(){e.CHM(a);const m=e.oxw(3);return e.KtG(m.export())}),e._uU(1,"PNG"),e.qZA()}}function L(o,d){if(1&o&&(e.ynx(0),e.YNc(1,b,3,6,"button",19),e.TgZ(2,"nz-dropdown-menu",null,20)(4,"ul",21),e.YNc(5,U,2,0,"li",22),e.YNc(6,I,2,0,"li",22),e.qZA()(),e.BQk()),2&o){const a=e.oxw(2);e.xp6(1),e.Q6J("ngIf",a.showExport),e.xp6(4),e.Q6J("ngIf",!a.isPngOnly),e.xp6(1),e.Q6J("ngIf",a.isPngOnly)}}function K(o,d){if(1&o&&(e.ynx(0),e.YNc(1,A,3,0,"ng-container",15),e.YNc(2,L,7,3,"ng-container",2),e.BQk()),2&o){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.showDuration)}}function k(o,d){if(1&o){const a=e.EpF();e.TgZ(0,"li",25),e.NdJ("click",function(){const h=e.CHM(a).$implicit,E=e.oxw();return e.KtG(E.onDurationChange(h))}),e._uU(1),e.TgZ(2,"small",26),e._uU(3),e.qZA()()}if(2&o){const a=d.$implicit,r=e.oxw();e.Q6J("nzSelected",a.key===(null==r.selectedDuration?null:r.selectedDuration.key)&&!r.dateRange.length),e.xp6(1),e.hij(" ",a.label," "),e.xp6(2),e.hij(" ",a.dates,"")}}const $=function(){return{standalone:!0}};let S=(()=>{var o;class d{get durationLabel(){const r="yy-MM-DD";return 2==this.dateRange.length?`${l()(this.dateRange[0]).format(r)} - ${l()(this.dateRange[1]).format(r)}`:this.selectedDuration?this.selectedDuration.label:"Duration"}get selectedDuration(){return this.api.getDuration()}constructor(r){this.api=r,this.showExport=!0,this.showDuration=!0,this.showArchivedToggle=!0,this.isPngOnly=!1,this.durationChanged=new e.vpe,this.exportFile=new e.vpe,this.isDurationLabelSelected=new e.vpe,this.includeArchived=!1,this.exporting=!1,this.dateRange=[],this.durations=[{label:"Yesterday",key:n.WD,dates:l()().subtract(1,"days").format("MMM,DD YYYY").toString()},{label:"Last 7 days",key:n.ao,dates:l()().subtract(1,"weeks").format("MMM,DD YYYY").toString()+" - "+l()().format("MMM,DD YYYY").toString()},{label:"Last week",key:n.$U,dates:l()().subtract(1,"weeks").startOf("week").format("MMM,DD YYYY").toString()+" - "+l()().subtract(1,"weeks").endOf("week").format("MMM,DD YYYY").toString()},{label:"Last 30 days",key:n.ly,dates:l()().subtract(1,"month").format("MMM,DD YYYY").toString()+" - "+l()().format("MMM,DD YYYY").toString()},{label:"Last month",key:n.lI,dates:l()().subtract(1,"month").startOf("month").format("MMM,DD YYYY").toString()+" - "+l()().subtract(1,"month").endOf("month").format("MMM,DD YYYY").toString()},{label:"Last 3 months",key:n.o9,dates:l()().subtract(3,"months").format("MMM,DD YYYY").toString()+" - "+l()().format("MMM,DD YYYY").toString()},{label:"All time",key:n.Si,dates:""}]}ngOnInit(){this.setInitialValues()}setInitialValues(){this.api.getDuration()||this.api.setDuration(this.durations.find(r=>r.key===n.ao)||null),this.api.getIncludeToggle()&&(this.includeArchived=this.api.getIncludeToggle())}onArchiveChange(r){this.api.setIncludeToggle(r),this.api.emitIncludeToggleChanged()}onDurationChange(r){this.isDurationLabelSelected.emit(!0),setTimeout(()=>{this.api.setDuration(r),this.api.setDrawerDuration(r),this.dateRange=[],this.api.setDateRange(this.dateRange),this.api.setDrawerDateRange(this.dateRange),this.api.emitDurationChanged()},500)}customDateChange(){this.isDurationLabelSelected.emit(!1),setTimeout(()=>{this.api.setDateRange(this.dateRange),this.api.setDrawerDateRange(this.dateRange),this.api.emitDateRangeChanged()})}export(){this.exportFile.emit()}}return(o=d).\u0275fac=function(r){return new(r||o)(e.Y36(T.m))},o.\u0275cmp=e.Xpm({type:o,selectors:[["worklenz-rpt-header"]],inputs:{title:"title",showExport:"showExport",showDuration:"showDuration",showArchivedToggle:"showArchivedToggle",isPngOnly:"isPngOnly"},outputs:{durationChanged:"durationChanged",exportFile:"exportFile",isDurationLabelSelected:"isDurationLabelSelected"},standalone:!0,features:[e.jDz],decls:21,vars:8,consts:[[1,"site-page-header-ghost-wrapper"],[1,"px-0",3,"nzGhost"],[4,"nzSpaceItem"],["timeSelector","nzDropdownMenu"],["nz-menu","","nzSelectable","",2,"max-height","330px","overflow-y","auto"],["nz-menu-item","",3,"nzSelected","click",4,"ngFor","ngForOf"],["nz-menu-divider",""],[1,"px-2","pb-2","pt-2","mt-1","custom-dropdown-range-li"],["nz-form",""],[1,"d-block","mt-1"],[1,"w-100",3,"ngModel","ngModelOptions","ngModelChange"],["nz-button","",1,"mt-2","ms-auto","d-block",3,"nzType","nzSize","click"],["nz-button","",3,"ngClass",4,"ngIf"],["nz-button","",3,"ngClass"],["nz-checkbox","",3,"ngModel","ngModelChange"],[4,"ngIf"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu","nzTrigger","nzPlacement",4,"nzSpaceItem"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu","nzTrigger","nzPlacement"],["nz-icon","",3,"nzType"],["nz-button","","nz-dropdown","",3,"nzType","nzLoading","nzTrigger","nzDropdownMenu","nzPlacement",4,"ngIf"],["exportMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngIf"],["nz-button","","nz-dropdown","",3,"nzType","nzLoading","nzTrigger","nzDropdownMenu","nzPlacement"],["nz-menu-item","",3,"click"],["nz-menu-item","",3,"nzSelected","click"],[1,"ms-auto","text-secondary"]],template:function(r,m){1&r&&(e.TgZ(0,"div",0)(1,"nz-page-header",1)(2,"nz-page-header-title"),e._uU(3),e.qZA(),e.TgZ(4,"nz-page-header-extra")(5,"nz-space"),e.YNc(6,P,2,1,"ng-container",2),e.YNc(7,K,3,1,"ng-container",2),e.qZA()()()(),e.TgZ(8,"nz-dropdown-menu",null,3)(10,"ul",4),e.YNc(11,k,4,3,"li",5),e._UZ(12,"li",6),e.TgZ(13,"li",7)(14,"form",8)(15,"label"),e._uU(16,"Custom range"),e.qZA(),e.TgZ(17,"div",9)(18,"nz-range-picker",10),e.NdJ("ngModelChange",function(E){return m.dateRange=E}),e.qZA()(),e.TgZ(19,"button",11),e.NdJ("click",function(){return m.customDateChange()}),e._uU(20," Filter "),e.qZA()()()()()),2&r&&(e.xp6(1),e.Q6J("nzGhost",!1),e.xp6(2),e.Oqu(m.title),e.xp6(8),e.Q6J("ngForOf",m.durations),e.xp6(7),e.Q6J("ngModel",m.dateRange)("ngModelOptions",e.DdM(7,$)),e.xp6(1),e.Q6J("nzType","primary")("nzSize","small"))},dependencies:[c.KJ,c.$O,c.u9,c.Jp,M.PV,M.Ls,D.zf,D.NU,D.$1,x.sL,x.ix,v.w,R.dQ,g.mk,u.u5,u._Y,u.JJ,u.JL,u.On,u.F,f.Wr,f.Ie,t.b1,w.wO,w.r9,w.YV,t.cm,t.RR,t.wA,g.sg,i.Hb,i.uw,i.wS,s.U5,s.Lr,g.O5],changeDetection:0}),d})()},69342:(C,z,_)=>{_.d(z,{O:()=>x});var e=_(26857),c=_(69649),M=_(65879),D=_(69862);let x=(()=>{var g;class u extends e.P{constructor(t){super(),this.http=t,this.root=`${this.API_BASE_URL}/reporting-export`}exportOverviewProjectsByTeam(t,n){const i=(0,c.UK)({team_id:t,team_name:n});window.location.href=`${this.root}/overview/projects${i}`}exportOverviewMembersByTeam(t,n){const i=(0,c.UK)({team_id:t,team_name:n});window.location.href=`${this.root}/overview/members${i}`}exportAllocation(t,n,i,s,p){const l=n?.join(","),T=i.join(",");window.location.href=`${this.root}/allocation/export${(0,c.UK)({teams:l,projects:T,duration:s,date_range:p,include_archived:t})}`}exportProjects(t){const n=(0,c.UK)({team_name:t});window.location.href=`${this.root}/projects/export${n}`}exportMembers(t,n,i,s){const p=(0,c.UK)({team_name:t,duration:n,date_range:i,archived:s});window.location.href=`${this.root}/members/export${p}`}exportProjectMembers(t,n,i){const s=(0,c.UK)({project_id:t,project_name:n,team_name:i||null});window.location.href=`${this.root}/project-members/export${s}`}exportProjectTasks(t,n,i){const s=(0,c.UK)({project_id:t,project_name:n,team_name:i||null});window.location.href=`${this.root}/project-tasks/export${s}`}exportMemberProjects(t,n,i,s,p){const l=(0,c.UK)({team_member_id:t,team_id:n,team_member_name:i,team_name:s||null,archived:p});window.location.href=`${this.root}/member-projects/export${l}`}exportMemberTasks(t,n,i,s){const p=(0,c.UK)({team_member_id:t,team_member_name:n,team_name:i||null,duration:s.duration,date_range:s.date_range,only_single_member:!!s.only_single_member&&s.only_single_member,archived:!!s.archived&&s.archived});window.location.href=`${this.root}/member-tasks/export${p}`}exportFlatTasks(t,n,i,s){const p=(0,c.UK)({team_member_id:t,team_member_name:n,project_id:i,project_name:s});window.location.href=`${this.root}/flat-tasks/export${p}`}exportProjectTimeLogs(t,n){const i=(0,c.UK)({id:t.id,duration:t.duration,date_range:t.date_range,project_name:n});window.location.href=`${this.root}/projects-time-log-breakdown/export${i}`}exportMemberTimeLogs(t){const n=(0,c.UK)({team_member_id:t.team_member_id,team_id:t.team_id,duration:t.duration,date_range:t.date_range,member_name:t.member_name,team_name:t.team_name,archived:!!t.archived&&t.archived});window.location.href=`${this.root}/member-time-log-breakdown/export${n}`}exportMemberActivityLogs(t){const n=(0,c.UK)({team_member_id:t.team_member_id,team_id:t.team_id,duration:t.duration,date_range:t.date_range,member_name:t.member_name,team_name:t.team_name,archived:!!t.archived&&t.archived});window.location.href=`${this.root}/member-activity-log-breakdown/export${n}`}}return(g=u).\u0275fac=function(t){return new(t||g)(M.LFG(D.eN))},g.\u0275prov=M.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),u})()}}]);