"use strict";(self.webpackChunkworklenz=self.webpackChunkworklenz||[]).push([[554],{9554:(Y,C,o)=>{o.r(C),o.d(C,{ClientsModule:()=>it});var f=o(96814),h=o(52787),d=o(15861),p=o(60095),S=o(21406),m=o(69649),t=o(65879),_=o(90586),x=o(99783),s=o(72042),z=o(64532),T=o(42840),Z=o(70855),M=o(41958),u=o(13740),J=o(10095),g=o(3599),v=o(20824),N=o(19035),E=o(62595),U=o(82962),P=o(92574),A=o(43389),F=o(8083),I=o(96109),b=o(24139),Q=o(82669),L=o(39787);function D(i,a){if(1&i){const l=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(l);const e=t.oxw().$implicit,r=t.oxw();return t.KtG(r.editClient(e.id))}),t._UZ(1,"span",18),t.qZA()}}function K(i,a){if(1&i){const l=t.EpF();t.TgZ(0,"button",19),t.NdJ("nzOnConfirm",function(){t.CHM(l);const e=t.oxw().$implicit,r=t.oxw();return t.KtG(r.deleteClient(e.id))}),t._UZ(1,"span",20),t.qZA()}}function B(i,a){if(1&i){const l=t.EpF();t.TgZ(0,"tr",10)(1,"td",11),t.NdJ("click",function(){const r=t.CHM(l).$implicit,c=t.oxw();return t.KtG(c.editClient(r.id))}),t.TgZ(2,"span"),t._uU(3),t.qZA()(),t.TgZ(4,"td",11),t.NdJ("click",function(){const r=t.CHM(l).$implicit,c=t.oxw();return t.KtG(c.editClient(r.id))}),t.TgZ(5,"span",12),t._uU(6),t.qZA()(),t.TgZ(7,"td",13)(8,"div",14)(9,"nz-space"),t.YNc(10,D,2,0,"button",15),t.YNc(11,K,2,0,"button",16),t.qZA()()()()}if(2&i){const l=a.$implicit;t.xp6(3),t.Oqu(l.name),t.xp6(3),t.hij(" ",(l.projects_count||0)<=0?"No projects available":(l.projects_count||0)+" Projects"," ")}}function $(i,a){1&i&&t._UZ(0,"span",28)}function G(i,a){if(1&i){const l=t.EpF();t.TgZ(0,"form",24),t.NdJ("ngSubmit",function(){t.CHM(l);const e=t.oxw(2);return t.KtG(e.searchProjects())}),t.TgZ(1,"nz-input-group",25),t._UZ(2,"input",26),t.qZA(),t.YNc(3,$,1,0,"ng-template",null,27,t.W1O),t.qZA()}if(2&i){const l=t.MAs(4),n=t.oxw(2);t.Q6J("formGroup",n.searchForm)("nzLayout","vertical"),t.xp6(1),t.Q6J("nzSuffix",l),t.xp6(1),t.Q6J("formControlName","search")}}function j(i,a){if(1&i){const l=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(l);const e=t.oxw(2);return t.KtG(e.showClientsModal=!0)}),t._uU(1,"Create Client"),t.qZA()}}function R(i,a){if(1&i&&t._UZ(0,"worklenz-toggle-menu-button",30),2&i){const l=t.oxw(2);t.Q6J("key",l.menu.CLIENTS_MENU)}}function H(i,a){1&i&&(t.TgZ(0,"nz-space"),t.YNc(1,G,5,4,"form",21),t.YNc(2,j,2,0,"button",22),t.YNc(3,R,1,1,"worklenz-toggle-menu-button",23),t.qZA())}function W(i,a){if(1&i){const l=t.EpF();t.ynx(0),t.TgZ(1,"nz-spin",31)(2,"form",32)(3,"nz-form-item")(4,"nz-form-label",33),t._uU(5,"Name"),t.qZA(),t.TgZ(6,"nz-form-control",34),t._UZ(7,"input",35),t.qZA()()(),t.TgZ(8,"button",36),t.NdJ("click",function(){t.CHM(l);const e=t.oxw();return t.KtG(e.handleOk())}),t._uU(9),t.qZA()(),t.BQk()}if(2&i){const l=t.oxw();t.xp6(1),t.Q6J("nzSpinning",l.loadingSingleClient),t.xp6(1),t.Q6J("formGroup",l.form)("nzLayout","vertical"),t.xp6(2),t.Q6J("nzSpan",null),t.xp6(2),t.Q6J("nzSpan",null),t.xp6(1),t.Q6J("formControlName","name"),t.xp6(2),t.Oqu(l.action)}}const V=function(){return{rows:5}},w=function(){return[]},k=[{path:"",component:(()=>{var i;class a{constructor(n,e,r,c,O){this.app=n,this.api=e,this.fb=r,this.menu=c,this.utilsService=O,this.showClientsModal=!1,this.client={},this.model={},this.loading=!1,this.loadingSingleClient=!1,this.action="Create",this.total=0,this.pageSize=S.L8,this.pageIndex=1,this.paginationSizes=[5,10,15,20,50,100],this.sortField=null,this.sortOrder=null,this.app.setTitle("Manage Clients"),this.form=this.fb.group({name:[null,[p.kI.required]]}),this.searchForm=this.fb.group({search:[]}),this.searchForm.valueChanges.subscribe(()=>this.searchProjects())}addClient(){var n=this;return(0,d.Z)(function*(){try{const e={name:n.form.controls.name.value};(yield n.api.create(e)).done&&(n.closeModal(),yield n.getClients())}catch(e){(0,m.tu)(e)}})()}getClients(){var n=this;return(0,d.Z)(function*(){try{n.loading=!0;const e=yield n.api.get(n.pageIndex,n.pageSize,n.sortField,n.sortOrder,n.searchForm.value.search);e.done&&(n.model=e.body,n.total=n.model.total||0,n.utilsService.handleLastIndex(n.total,n.model.data?.length||0,n.pageIndex,r=>{n.pageIndex=r,n.getClients()})),n.loading=!1}catch(e){(0,m.tu)(e),n.loading=!1}})()}getClient(n){var e=this;return(0,d.Z)(function*(){try{e.loadingSingleClient=!0;const r=yield e.api.getById(n);r.done&&(e.client=r.body,e.form.controls.name.setValue(e.client.name)),e.loadingSingleClient=!1}catch(r){(0,m.tu)(r),e.loadingSingleClient=!1}})()}updateClient(){var n=this;return(0,d.Z)(function*(){if(n.client&&n.client.id)try{n.loadingSingleClient=!0;const e={name:n.form.controls.name.value},r=yield n.api.update(n.client.id,e);n.loadingSingleClient=!1,r.done&&(n.closeModal(),yield n.getClients())}catch(e){n.loadingSingleClient=!1,(0,m.tu)(e)}})()}deleteClient(n){var e=this;return(0,d.Z)(function*(){if(n)try{(yield e.api.delete(n)).done&&(yield e.getClients())}catch(r){(0,m.tu)(r)}})()}editClient(n){var e=this;return(0,d.Z)(function*(){n&&(yield e.getClient(n),e.action="Update",e.showClientsModal=!0)})()}closeModal(){this.showClientsModal=!1,this.form.reset(),this.action="Create"}handleOk(){var n=this;return(0,d.Z)(function*(){n.client&&n.client.id?yield n.updateClient():yield n.addClient()})()}searchProjects(){var n=this;return(0,d.Z)(function*(){n.getClients()})()}onQueryParamsChange(n){var e=this;return(0,d.Z)(function*(){const{pageSize:r,pageIndex:c,sort:O}=n;e.pageIndex=c,e.pageSize=r;const y=O.find(lt=>null!==lt.value);e.sortField=y&&y.key||null,e.sortOrder=y&&y.value||null,yield e.getClients()})()}}return(i=a).\u0275fac=function(n){return new(n||i)(t.Y36(_.z),t.Y36(x.Q),t.Y36(p.qu),t.Y36(s.h),t.Y36(z.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["worklenz-clients"]],decls:16,vars:18,consts:[[3,"nzExtra"],[3,"nzActive","nzLoading","nzParagraph"],["nzShowSizeChanger","","nzSize","small",1,"custom-table",3,"nzData","nzFrontPagination","nzLoading","nzPageIndex","nzPageSizeOptions","nzPageSize","nzTotal","nzQueryParams"],["table",""],["nzAlign","left","nzColumnKey","name","scope","col",3,"nzSortFn"],["colspan","2","nzAlign","left","scope","col"],["class","actions-row",4,"ngFor","ngForOf"],["searchTemplate",""],["nzPlacement","right",3,"nzVisible","nzClosable","nzTitle","nzOnClose","nzVisibleChange"],[4,"nzDrawerContent"],[1,"actions-row"],[1,"cursor-pointer",3,"click"],["nz-typography","","nzType","secondary"],[1,"actions-col"],[1,"actions"],["nz-button","","nz-tooltip","","nzSize","small","nzTooltipPlacement","top","nzTooltipTitle","Edit","nzType","default",3,"click",4,"nzSpaceItem"],["nz-button","","nz-popconfirm","","nz-tooltip","","nzOkText","Yes","nzPopconfirmTitle","Are you sure?","nzSize","small","nzTooltipPlacement","top","nzTooltipTitle","Delete","nzType","default",3,"nzOnConfirm",4,"nzSpaceItem"],["nz-button","","nz-tooltip","","nzSize","small","nzTooltipPlacement","top","nzTooltipTitle","Edit","nzType","default",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nz-popconfirm","","nz-tooltip","","nzOkText","Yes","nzPopconfirmTitle","Are you sure?","nzSize","small","nzTooltipPlacement","top","nzTooltipTitle","Delete","nzType","default",3,"nzOnConfirm"],["nz-icon","","nzType","delete"],["nz-form","",3,"formGroup","nzLayout","ngSubmit",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],[3,"key",4,"nzSpaceItem"],["nz-form","",3,"formGroup","nzLayout","ngSubmit"],[3,"nzSuffix"],["nz-input","","placeholder","Search by name","type","text",3,"formControlName"],["suffixIconSearch",""],["nz-icon","","nzType","search"],["nz-button","","nzType","primary",3,"click"],[3,"key"],[3,"nzSpinning"],["nz-form","",3,"formGroup","nzLayout"],["nzRequired","",3,"nzSpan"],["nzErrorTip","Please enter a name!",3,"nzSpan"],["nz-input","","placeholder","Name",3,"formControlName"],["nz-button","","nzBlock","","nzType","primary","type","button",3,"click"]],template:function(n,e){if(1&n&&(t.TgZ(0,"nz-card",0)(1,"nz-skeleton",1)(2,"nz-table",2,3),t.NdJ("nzQueryParams",function(c){return e.onQueryParamsChange(c)}),t.TgZ(4,"thead")(5,"tr")(6,"th",4),t._uU(7,"Name"),t.qZA(),t.TgZ(8,"th",5),t._uU(9,"Projects"),t.qZA()()(),t.TgZ(10,"tbody"),t.YNc(11,B,12,2,"tr",6),t.qZA()()(),t.YNc(12,H,4,0,"ng-template",null,7,t.W1O),t.qZA(),t.TgZ(14,"nz-drawer",8),t.NdJ("nzOnClose",function(){return e.closeModal()})("nzVisibleChange",function(c){return e.showClientsModal=c}),t.YNc(15,W,10,7,"ng-container",9),t.qZA()),2&n){const r=t.MAs(3),c=t.MAs(13);t.Q6J("nzExtra",c),t.xp6(1),t.Q6J("nzActive",!0)("nzLoading",e.loading)("nzParagraph",t.DdM(16,V)),t.xp6(1),t.Q6J("nzData",e.model.data||t.DdM(17,w))("nzFrontPagination",!1)("nzLoading",e.loading)("nzPageIndex",e.pageIndex)("nzPageSizeOptions",e.paginationSizes)("nzPageSize",e.pageSize)("nzTotal",e.total),t.xp6(4),t.Q6J("nzSortFn",!0),t.xp6(5),t.Q6J("ngForOf",r.data),t.xp6(3),t.MGl("nzTitle","",e.action," Client"),t.Q6J("nzVisible",e.showClientsModal)("nzClosable",!0)}},dependencies:[f.sg,T.ix,Z.w,M.dQ,u.N8,u.qD,u.Uo,u._C,u.Om,u.p0,u.$Z,u.UX,J.t3,J.SK,g.Lr,g.Nx,g.iK,g.Fd,p._Y,p.Fj,p.JJ,p.JL,p.sg,p.u,v.Zp,v.gB,v.ke,N.JW,E.Ls,U.bd,P.NU,P.$1,A.Vz,A.SQ,F.ZU,I.SY,b.ng,Q.W,L.l]}),a})()}];let X=(()=>{var i;class a{}return(i=a).\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(k),h.Bz]}),a})();var q=o(26254),tt=o(66987),nt=o(81221),et=o(3626),ot=o(33410);let it=(()=>{var i;class a{}return(i=a).\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[f.ez,X,q.KJ,T.sL,u.HQ,tt.S,nt.Qp,g.U5,p.UX,v.o7,N._p,et.lt,E.PV,U.vh,ot.wm,P.zf,A.BL,F.ZJ,I.cg,b.H0,Q.j,L.l]}),a})()},99783:(Y,C,o)=>{o.d(C,{Q:()=>m});var f=o(10708),h=o(26857),d=o(69649),p=o(65879),S=o(69862);let m=(()=>{var t;class _ extends h.P{constructor(s){super(),this.http=s,this.root=`${this.API_BASE_URL}/clients`}create(s){return this._post(this.http,this.root,s)}get(s,z,T,Z,M){const u=encodeURIComponent(M||"");return this._get(this.http,`${this.root}${(0,d.UK)({index:s,size:z,field:T,order:Z,search:u})}`)}getById(s){return this._get(this.http,`${this.root}/${s}`)}update(s,z){return this._put(this.http,`${this.root}/${s}`,z)}delete(s){return(0,f.n)(this.http.delete(`${this.root}/${s}`))}}return(t=_).\u0275fac=function(s){return new(s||t)(p.LFG(S.eN))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),_})()}}]);